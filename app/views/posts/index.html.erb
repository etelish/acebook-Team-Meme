<% @posts.each do |post| %>
<% @post_creator_id = post.user_id.to_i %>
<% @post_creator = User.find_by(id: @post_creator_id) %>

<p><%= simple_format post.message %></br>Posted on: <%= post.created_at %>
  by <%= @post_creator.firstname + " " + @post_creator.surname %></p>
  <p><%= link_to 'Show', post_path(post),
    method: :get %>
    <%= link_to 'Edit', edit_post_path(post),
    method: :get %>
    
    <% if @post_creator_id == current_user.id %>
      <%= link_to 'Delete', post_path(post), class: "#{post.id}",
      method: :delete %>
    <% else %>
      <%=flash[:notice] = "Check yourself before you wreck yourself!!"%></p>
    <% end %>

    <h2>Commments:</h2>
    <% post.comments.each do |comment| %>
    <% @comment_creator = User.find_by(id: comment.user_id) %>
       <p><%= @comment_creator.firstname + ' ' +  @comment_creator.surname %> 
       commented: <%= comment.body %> on <%= comment.created_at %></p><br>
    <% end %>

    <h2>Add a comment:</h2>
    <%= form_with(model: [ post, post.comments.build ], local: true) do
      |form| %>
      <p>
        <%= form.text_area :body %>
      </p>
      <p>
        <%= form.submit %>
      </p>
    <% end %>

<% end %>

    <%= link_to new_post_path do %>
    New post
    <% end %>
